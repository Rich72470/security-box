<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">
<head>
<meta charset="UTF-8"/>
<title>Micro DC Motor with Encoder-SJ01 SKU: FIT0450 - Robot Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450","wgTitle":"Micro DC Motor with Encoder-SJ01 SKU: FIT0450","wgCurRevisionId":34539,"wgRevisionId":34539,"wgArticleId":11964,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450","wgRelevantArticleId":11964,"wgRequestId":"3554013eaea7836030816e31","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","usePageImages":false,"usePageDescriptions":false},"wgVisualEditorToolbarScrollOffset":0});mw.loader.implement("user.options",function($,jQuery,require,module){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function ( $, jQuery, require, module ) {
mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});/*@nomin*/;

});mw.loader.load(["mediawiki.page.startup","ext.visualEditor.desktopArticleTarget.init"]);});</script>
<link rel="stylesheet" href="/wiki/load.php?debug=false&amp;lang=en&amp;modules=ext.bootstrap.styles%7Cext.pygments%7Cext.visualEditor.desktopArticleTarget.noscript&amp;only=styles&amp;skin=chameleon"/>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/wiki/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=chameleon"/>
<script async="" src="/wiki/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=chameleon"></script>
<meta name="generator" content="MediaWiki 1.27.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link rel="shortcut icon" href="/wiki/resources/assets/wiki.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/wiki/opensearch_desc.php" title="Robot Wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://www.dfrobot.com/wiki/api.php?action=rsd"/>
<link rel="copyright" href="https://www.gnu.org/copyleft/fdl.html"/>
<link rel="alternate" type="application/atom+xml" title="Robot Wiki Atom feed" href="/wiki/index.php?title=Special:RecentChanges&amp;feed=atom"/>
</head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Micro_DC_Motor_with_Encoder-SJ01_SKU_FIT0450 rootpage-Micro_DC_Motor_with_Encoder-SJ01_SKU_FIT0450 layout-navhead skin-chameleon action-view">

	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<!-- navigation bar -->
				<nav class="navbar navbar-default p-navbar" role="navigation" id="mw-navigation">
					<div class="container-fluid">
						<div class="navbar-header">

							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mw-navigation-collapse">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
							</button>

							<!-- logo and main page link -->
							<div id="p-logo" class="p-logo navbar-brand" role="banner">
								<a><img src="/wiki/resources/assets/wiki.png" alt="Robot Wiki"/></a>
							</div>


						</div>

						<div class="collapse navbar-collapse" id="mw-navigation-collapse"><ul class="nav navbar-nav">
							<!-- navigation -->
							<!-- empty -->
							<!-- Product Manual -->
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Product Manual <b class="caret"></b></a>
								
								<ul class="dropdown-menu p-Product Manual" id="p-Product Manual">
										<li id="n-DFR-Series"><a href="/wiki/index.php/Product_Manual#DFR_Series">DFR Series</a></li>
										<li id="n-SEN-Series"><a href="/wiki/index.php/Product_Manual#SEN_Series">SEN Series</a></li>
										<li id="n-DRI-Series"><a href="/wiki/index.php/Product_Manual#DRI_Series">DRI Series</a></li>
										<li id="n-TEL-Series"><a href="/wiki/index.php/Product_Manual#TEL_Series">TEL Series</a></li>
										<li id="n-FIT-Series"><a href="/wiki/index.php/Product_Manual#FIT_Series">FIT Series</a></li>
										<li id="n-ROB-Series"><a href="/wiki/index.php/Product_Manual#ROB_Series">ROB Series</a></li>
										<li id="n-SER-Series"><a href="/wiki/index.php/Product_Manual#SER_Series">SER Series</a></li>
										<li id="n-TOY-Series"><a href="/wiki/index.php/Product_Manual#TOY_Series">TOY Series</a></li>
										<li id="n-KIT-Series"><a href="/wiki/index.php/Product_Manual#KIT_Series">KIT Series</a></li>
										<li id="n-Selector-Guide"><a href="/wiki/index.php/Product_Manual#Selector_Guide">Selector Guide</a></li>
										<li id="n-Review"><a href="/wiki/index.php/Review">Review</a></li>
										<li id="n-Project"><a href="/wiki/index.php/Project">Project</a></li>
										<li id="n-Tutorial"><a href="/wiki/index.php/Tutorial">Tutorial</a></li>
										<li id="n-Assembly-Guide"><a href="/wiki/index.php/Assembly_Guide">Assembly Guide</a></li>
								</ul>
							</li>
							<!-- Tutorials -->
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
								
								<ul class="dropdown-menu p-Tutorials" id="p-Tutorials">
										<li id="n-User-Manual"><a href="/wiki/index.php/Product_Manual#User_Manual">User Manual</a></li>
										<li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" title="The place to find out">Help</a></li>
								</ul>
							</li>
							<!-- Menu -->
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Menu <b class="caret"></b></a>
								
								<ul class="dropdown-menu p-Menu" id="p-Menu">
										<li id="n-HOME"><a href="https://www.dfrobot.com/" rel="nofollow">HOME</a></li>
										<li id="n-STORE"><a href="https://www.dfrobot.com/store" rel="nofollow">STORE</a></li>
										<li id="n-BLOG"><a href="https://www.dfrobot.com/blog" rel="nofollow">BLOG</a></li>
										<li id="n-WIKI"><a href="https://www.dfrobot.com/wiki" rel="nofollow">WIKI</a></li>
										<li id="n-COMMUNITY"><a href="https://www.dfrobot.com/blog" rel="nofollow">COMMUNITY</a></li>
								</ul>
							</li></ul>

							<div class="navbar-right-aligned">
								<!-- page tools -->
								<ul class="navbar-tools navbar-nav" >
									<li class="navbar-tools-tools dropdown">
										<a data-toggle="dropdown" class="dropdown-toggle" href="#" title="Page tools" ><span>...</span></a>
										<!-- Content navigation -->
										<ul class="p-contentnavigation dropdown-menu" id="p-contentnavigation">
											<!-- namespaces -->
											<li id="ca-talk" class="new"><a href="/wiki/index.php?title=Talk:Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t" class="new">Discussion</a></li>
											<!-- views -->
											<li id="ca-viewsource"><a href="/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
											<li id="ca-history"><a href="/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
										</ul>
									</li>
								</ul>

								<!-- search form -->
								<div  id="p-search" class="p-search navbar-form" role="search">
									<form  id="searchform" class="mw-search form-inline" action="/wiki/index.php">
										<input type="hidden" name="title" value="Special:Search" />
										<div class="input-group">
											<input name="search" placeholder="Search" title="Search Robot Wiki [f]" accesskey="f" id="searchInput" class="form-control"/>
											<div class="input-group-btn">
												<button value="Go" id="searchGoButton" name="go" title="Go to a page with this exact name if it exists" type="submit" class="searchGoButton btn btn-default"><span class="glyphicon glyphicon-share-alt"></span></button>
												<button value="Search" id="mw-searchButton" name="fulltext" title="Search the pages for this text" type="submit" class="mw-searchButton btn btn-default"><span class="glyphicon glyphicon-search"></span></button>
											</div>
										</div>
									</form>
								</div>

								<!-- personal tools -->
								<ul class="navbar-tools navbar-nav" >
									<li class="dropdown navbar-tools-tools">
										<a class="dropdown-toggle navbar-usernotloggedin" href="#" data-toggle="dropdown" title="You are not logged in." ><span class="glyphicon glyphicon-user"></span></a>
										<ul class="p-personal-tools dropdown-menu dropdown-menu-right" >
											<li id="pt-login"><a href="/wiki/index.php?title=Special:UserLogin&amp;returnto=Micro+DC+Motor+with+Encoder-SJ01+SKU%3A+FIT0450" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
										</ul>
									</li>
								</ul>

							</div> <!-- navbar-right-aligned -->
						</div><!-- /.navbar-collapse -->
					</div>
				</nav>

			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">

			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">
				<!-- start the content area -->
				<div id="content" class="mw-body"><a id="top"></a>
					<div id="mw-indicators" class="mw-indicators"></div>
					<div  id="mw-js-message" style="display:none;"></div>
					<div class ="contentHeader">
						<!-- title of the page -->
						<h1 id="firstHeading" class="firstHeading">Micro DC Motor with Encoder-SJ01 SKU: FIT0450</h1>
						<!-- tagline; usually goes something like "From WikiName" primary purpose of this seems to be for printing to identify the source of the content -->
						<div id="siteSub">From Robot Wiki</div><div id="jump-to-nav" class="mw-jump">Jump to:<a href="#mw-navigation">navigation</a>, <a href="#p-search">search</a></div>
					</div>
					<div id="bodyContent">
						<!-- body text -->

						<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="/wiki/index.php/File:W4A9932.JPG" class="image"><img alt="" src="/wiki/images/thumb/b/b1/W4A9932.JPG/300px-W4A9932.JPG" width="300" height="300" class="thumbimage" srcset="/wiki/images/thumb/b/b1/W4A9932.JPG/450px-W4A9932.JPG 1.5x, /wiki/images/b/b1/W4A9932.JPG 2x" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/wiki/index.php/File:W4A9932.JPG" class="internal" title="Enlarge"></a></div>Editing Micro DC Motor with Encoder-SJ01 SKU: FIT0450</div></div></div>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Specification"><span class="tocnumber">2</span> <span class="toctext">Specification</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Pin_Description"><span class="tocnumber">3</span> <span class="toctext">Pin Description</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Tutorial"><span class="tocnumber">4</span> <span class="toctext">Tutorial</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Ready_to_Work"><span class="tocnumber">4.1</span> <span class="toctext">Ready to Work</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Wiring_Diagram"><span class="tocnumber">4.2</span> <span class="toctext">Wiring Diagram</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Interrupt_Port_with_Different_Board"><span class="tocnumber">4.3</span> <span class="toctext"><b>Interrupt Port with Different Board</b></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Encoder_Sample_Code_1"><span class="tocnumber">4.4</span> <span class="toctext">Encoder Sample Code 1</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Encoder_Sample_Code2"><span class="tocnumber">4.5</span> <span class="toctext">Encoder Sample Code2</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10"><a href="#More"><span class="tocnumber">5</span> <span class="toctext">More</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>This is the DFRobot Micro DC geared motor with encoder. It is a motor with a 120:1 gearbox and an integrated quadrature encoder that provides a resolution of 16 pulse single per round giving a maximum output of 1920 within one round. <br />
With an Arduino controller and motor driver, applications for this might include a closed-loop PID control or PWM motor speed control. This motor is an ideal option for mobile robot projects. The copper output shaft, embedded thread and reinforced connector greatly extends the motor's service life.
</p>
<h2><span class="mw-headline" id="Specification">Specification</span></h2>
<ul><li>Gear ratio: 120:1</li>
<li>No-load speed @ 6V: 160 rpm</li>
<li>No-load speed @ 3V: 60 rpm</li>
<li>No-load current @ 6V: 0.17A</li>
<li>No-load current @ 3V: 0.14A</li>
<li>Max Stall current: 2.8A</li>
<li>Max Stall torque: 0.8kgf.cm</li>
<li>Rated torque: 0.2kgf.cm</li>
<li>Encoder operating voltage: 4.5~7.5V</li>
<li>Motor operating voltage: 3~7.5V (Rated voltage 6V)</li>
<li>Operating ambient temperature: -10~+60℃</li></ul>
<h2><span class="mw-headline" id="Pin_Description">Pin Description</span></h2>
<table style="width:100%">
<tr>
<th style="width: 40%;">
</th>
<th style="width: 60%;">
</th></tr>
<tr style="vertical-align:top;">
<td style="padding: 5px;">
<p><a href="/wiki/index.php/File:FIT0450.png" class="image"><img alt="FIT0450.png" src="/wiki/images/5/52/FIT0450.png" width="559" height="406" /></a>
</p>
</td>
<td style="padding: 20px;">
<table style="width:80%; height:250px;">

<tr style="background-color:#78CDF8; height:40px;" align="right">
<td><b>Grade</b></td>
<td><b>Name</b></td>
<td><b>Functional Description</b>
</td></tr>
<tr>
<td>   1   </td>
<td> Motor power supply pin +  </td>
<td>   3-7.5V，Rated voltage6V
</td></tr>
<tr style="background-color:#E2F1F9;">
<td>   2   </td>
<td> Motor power supply pin -  </td>
<td>
</td></tr>
<tr>
<td>   3   </td>
<td>  Encoder A phase output  </td>
<td>   Changes square wave with the output frequency of Motor speed
</td></tr>
<tr style="background-color:#E2F1F9;">
<td>   4   </td>
<td>  Encoder B phase output  </td>
<td>   Changes square wave with the output frequency of Motor speed(interrupt port)
</td></tr>
<tr>
<td>   5   </td>
<td>  Encoder supply GND   </td>
<td>
</td></tr>
<tr style="background-color:#E2F1F9;">
<td>   6   </td>
<td>  Encoder supply +  </td>
<td>   4.5-7.5V
</td></tr></table>
</td></tr></table>
<p><br />
<br />
</p>
<h2><span class="mw-headline" id="Tutorial">Tutorial</span></h2>
<h3><span class="mw-headline" id="Ready_to_Work">Ready to Work</span></h3>
<ul><li><b>hardware</b>
<ul><li><a rel="nofollow" class="external text" href="http://www.dfrobot.com/index.php?route=product/product&amp;product_id=610&amp;search=uno&amp;description=true&amp;category_id=48">DFRduino UNO</a> x1</li>
<li>DC power supply x1</li>
<li><a rel="nofollow" class="external text" href="http://www.dfrobot.com/index.php?route=product/product&amp;product_id=1180&amp;search=L298&amp;description=true&amp;category_id=48#.VymjzUf1pmQ">L298</a>  x1</li></ul></li>
<li><b>software</b>
<ul><li>Arduino IDE  <a rel="nofollow" class="external text" href="https://www.arduino.cc/en/Main/Software">Download Arduino IDE</a></li></ul></li></ul>
<p><br />
</p>
<h3><span class="mw-headline" id="Wiring_Diagram">Wiring Diagram</span></h3>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:584px;"><a href="/wiki/index.php/File:FIT0450%2BUNO.png" class="image"><img alt="FIT0450+UNO.png" src="/wiki/images/8/8f/FIT0450%2BUNO.png" width="582" height="782" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/wiki/index.php/File:FIT0450%2BUNO.png" class="internal" title="Enlarge"></a></div></div></div></div></div>
<p>This tutorial is about Encoder usage. We are using D2&amp;D3 as driving pins, you can select other ones, but it requires at least 1 interrupt pin. (We selected D2, Interrupt 0 in this tutorial).
</p><p><br />
</p>
<h3><span class="mw-headline" id="Interrupt_Port_with_Different_Board"><b>Interrupt Port with Different Board</b></span></h3>
<p><i><b>Notice:</b></i> attachInterrupt()
</p>
<div class="center"><div class="thumb tnone"><div class="thumbinner" style="width:700px;"><a href="/wiki/index.php/File:Interrupt.png" class="image"><img alt="Interrupt.png" src="/wiki/images/2/20/Interrupt.png" width="698" height="129" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="/wiki/index.php/File:Interrupt.png" class="internal" title="Enlarge"></a></div></div></div></div></div>
<p>If using an Arduino UNO and you want to use interrupt port 0 (Int.0), you need to connect digital pin D2 on the board. The following code is only used in UNO and Mega2560. If you want to use Arduino Leonardo, you should change digital pin D3 instead of digital pin D2. 
</p><p><i><b>See the link for details  <a rel="nofollow" class="external free" href="http://arduino.cc/en/Reference/AttachInterrupt">http://arduino.cc/en/Reference/AttachInterrupt</a></b></i>
</p><p><br />
</p>
<h3><span class="mw-headline" id="Encoder_Sample_Code_1">Encoder Sample Code 1</span></h3>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">//The sample code for driving one way motor encoder</span>
<span class="k">const</span> <span class="n">byte</span> <span class="n">encoder0pinA</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="c1">//A pin -&gt; the interrupt pin 0</span>
<span class="k">const</span> <span class="n">byte</span> <span class="n">encoder0pinB</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="c1">//B pin -&gt; the digital pin 3</span>
<span class="n">byte</span> <span class="n">encoder0PinALast</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">duration</span><span class="p">;</span><span class="c1">//the number of the pulses</span>
<span class="n">boolean</span> <span class="n">Direction</span><span class="p">;</span><span class="c1">//the rotation direction </span>
 
 
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>  
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">57600</span><span class="p">);</span><span class="c1">//Initialize the serial port</span>
  <span class="n">EncoderInit</span><span class="p">();</span><span class="c1">//Initialize the module</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Pulse:&quot;</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
  <span class="n">duration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">EncoderInit</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Direction</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span><span class="c1">//default -&gt; Forward  </span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">encoder0pinB</span><span class="p">,</span><span class="n">INPUT</span><span class="p">);</span>  
  <span class="n">attachInterrupt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wheelSpeed</span><span class="p">,</span> <span class="n">CHANGE</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">wheelSpeed</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">Lstate</span> <span class="o">=</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">encoder0pinA</span><span class="p">);</span>
  <span class="k">if</span><span class="p">((</span><span class="n">encoder0PinALast</span> <span class="o">==</span> <span class="n">LOW</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">Lstate</span><span class="o">==</span><span class="n">HIGH</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">encoder0pinB</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">LOW</span> <span class="o">&amp;&amp;</span> <span class="n">Direction</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Direction</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="c1">//Reverse</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">HIGH</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Direction</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Direction</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">//Forward</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">encoder0PinALast</span> <span class="o">=</span> <span class="n">Lstate</span><span class="p">;</span>
 
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">Direction</span><span class="p">)</span>  <span class="n">duration</span><span class="o">++</span><span class="p">;</span>
  <span class="k">else</span>  <span class="n">duration</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
<p><b>Code 1 phenomenon:</b> <br />
<br />
Explanation: Serial data, when the motor forward, the output value&gt; 0, when the motor reverse rotation, digital output &lt;0. The faster the motor speed, the greater the absolute value of number.
</p>
<div class="center"><div class="floatnone"><a href="/wiki/index.php/File:FIT0450_data_out.png" class="image"><img alt="FIT0450 data out.png" src="/wiki/images/4/46/FIT0450_data_out.png" width="447" height="474" /></a></div></div>
<h3><span class="mw-headline" id="Encoder_Sample_Code2">Encoder Sample Code2</span></h3>
<p><b>PID control：</b> PID algorithm to control the motor speed by L298P DC motor driver board 
</p>
<ol><li>Motor power port is connected to the L298 drive motor M1 port</li>
<li>Download and install <a rel="nofollow" class="external text" href="https://github.com/br3ttb/Arduino-PID-Library/">Arduino PID</a></li></ol>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c1">//The sample code for driving one way motor encoder</span>
<span class="cp">#include</span> <span class="cpf">&lt;PID_v1.h&gt;</span><span class="cp"></span>
<span class="k">const</span> <span class="n">byte</span> <span class="n">encoder0pinA</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span><span class="c1">//A pin -&gt; the interrupt pin 0</span>
<span class="k">const</span> <span class="n">byte</span> <span class="n">encoder0pinB</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="c1">//B pin -&gt; the digital pin 3</span>
<span class="kt">int</span> <span class="n">E_left</span> <span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="c1">//The enabling of L298PDC motor driver board connection to the digital interface port 5</span>
<span class="kt">int</span> <span class="n">M_left</span> <span class="o">=</span><span class="mi">4</span><span class="p">;</span> <span class="c1">//The enabling of L298PDC motor driver board connection to the digital interface port 4</span>
<span class="n">byte</span> <span class="n">encoder0PinALast</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">duration</span><span class="p">,</span><span class="n">abs_duration</span><span class="p">;</span><span class="c1">//the number of the pulses</span>
<span class="n">boolean</span> <span class="n">Direction</span><span class="p">;</span><span class="c1">//the rotation direction </span>
<span class="n">boolean</span> <span class="n">result</span><span class="p">;</span>

<span class="kt">double</span> <span class="n">val_output</span><span class="p">;</span><span class="c1">//Power supplied to the motor PWM value.</span>
<span class="kt">double</span> <span class="n">Setpoint</span><span class="p">;</span>
<span class="kt">double</span> <span class="n">Kp</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">Ki</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">Kd</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>  
<span class="n">PID</span> <span class="nf">myPID</span><span class="p">(</span><span class="o">&amp;</span><span class="n">abs_duration</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val_output</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Setpoint</span><span class="p">,</span> <span class="n">Kp</span><span class="p">,</span> <span class="n">Ki</span><span class="p">,</span> <span class="n">Kd</span><span class="p">,</span> <span class="n">DIRECT</span><span class="p">);</span> 
 
<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
<span class="p">{</span>  
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span><span class="c1">//Initialize the serial port</span>
   <span class="n">pinMode</span><span class="p">(</span><span class="n">M_left</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>   <span class="c1">//L298P Control port settings DC motor driver board for the output mode</span>
   <span class="n">pinMode</span><span class="p">(</span><span class="n">E_left</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span> 
   <span class="n">Setpoint</span> <span class="o">=</span><span class="mi">80</span><span class="p">;</span>  <span class="c1">//Set the output value of the PID</span>
   <span class="n">myPID</span><span class="p">.</span><span class="n">SetMode</span><span class="p">(</span><span class="n">AUTOMATIC</span><span class="p">);</span><span class="c1">//PID is set to automatic mode</span>
   <span class="n">myPID</span><span class="p">.</span><span class="n">SetSampleTime</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span><span class="c1">//Set PID sampling frequency is 100ms</span>
  <span class="n">EncoderInit</span><span class="p">();</span><span class="c1">//Initialize the module</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>   
      <span class="n">advance</span><span class="p">();</span><span class="c1">//Motor Forward</span>
      <span class="n">abs_duration</span><span class="o">=</span><span class="n">abs</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
      <span class="n">result</span><span class="o">=</span><span class="n">myPID</span><span class="p">.</span><span class="n">Compute</span><span class="p">();</span><span class="c1">//PID conversion is complete and returns 1</span>
      <span class="k">if</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
      <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Pluse: &quot;</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span> 
        <span class="n">duration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//Count clear, wait for the next count</span>
      <span class="p">}</span>
        

<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">EncoderInit</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">Direction</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span><span class="c1">//default -&gt; Forward  </span>
  <span class="n">pinMode</span><span class="p">(</span><span class="n">encoder0pinB</span><span class="p">,</span><span class="n">INPUT</span><span class="p">);</span>  
  <span class="n">attachInterrupt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">wheelSpeed</span><span class="p">,</span> <span class="n">CHANGE</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="kt">void</span> <span class="nf">wheelSpeed</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">Lstate</span> <span class="o">=</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">encoder0pinA</span><span class="p">);</span>
  <span class="k">if</span><span class="p">((</span><span class="n">encoder0PinALast</span> <span class="o">==</span> <span class="n">LOW</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">Lstate</span><span class="o">==</span><span class="n">HIGH</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">digitalRead</span><span class="p">(</span><span class="n">encoder0pinB</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">LOW</span> <span class="o">&amp;&amp;</span> <span class="n">Direction</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Direction</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span> <span class="c1">//Reverse</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="n">HIGH</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Direction</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="n">Direction</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>  <span class="c1">//Forward</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">encoder0PinALast</span> <span class="o">=</span> <span class="n">Lstate</span><span class="p">;</span>
 
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">Direction</span><span class="p">)</span>  <span class="n">duration</span><span class="o">++</span><span class="p">;</span>
  <span class="k">else</span>  <span class="n">duration</span><span class="o">--</span><span class="p">;</span>

<span class="p">}</span>
<span class="kt">void</span> <span class="nf">advance</span><span class="p">()</span><span class="c1">//Motor Forward</span>
<span class="p">{</span>
     <span class="n">digitalWrite</span><span class="p">(</span><span class="n">M_left</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span>
     <span class="n">analogWrite</span><span class="p">(</span><span class="n">E_left</span><span class="p">,</span><span class="n">val_output</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">back</span><span class="p">()</span><span class="c1">//Motor reverse</span>
<span class="p">{</span>
     <span class="n">digitalWrite</span><span class="p">(</span><span class="n">M_left</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span>
     <span class="n">analogWrite</span><span class="p">(</span><span class="n">E_left</span><span class="p">,</span><span class="n">val_output</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Stop</span><span class="p">()</span><span class="c1">//Motor stops</span>
<span class="p">{</span>
     <span class="n">digitalWrite</span><span class="p">(</span><span class="n">E_left</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span> 
<span class="p">}</span>
</pre></div>
<p><b>Code 2 phenomenon:</b> <br />
<br />
</p><p>The code PID value has been set as 80, so the motor will stabilize at about 80 rpm. If outside forces such as changes in motor drive voltage, the motor's resistance, etc affect the speed, the program will adjust the PWM value to stabilize the rotational speed at 80.  
</p><p><br /><br />
</p>
<h2><span class="mw-headline" id="More">More</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/Arduinolibrary/DFRobot_Micro_DC_Geared_Motor_with_Encoder/raw/master/FIT0450%20Micro%20DC%20Motor%20with%20Encoder-SJ01.pdf">Motor dimension drawing</a></li></ul>
<p><br /><br />
</p>
<dl><dd><a href="http://www.dfrobot.com/" rel="nofollow"><img alt="DFshopping car1.png" src="/wiki/images/thumb/9/97/DFshopping_car1.png/25px-DFshopping_car1.png" width="25" height="23" srcset="/wiki/images/9/97/DFshopping_car1.png 1.5x, /wiki/images/9/97/DFshopping_car1.png 2x" /></a>   Shopping from <a rel="nofollow" class="external text" href="http://www.dfrobot.com/index.php"><b>DFRobot Store</b></a> or <a rel="nofollow" class="external text" href="http://www.dfrobot.com/index.php?route=information/distributorslogo"><b>DFRobot Distributor</b>.</a></dd></dl>
<p><br /><br />
</p>
<!-- 
NewPP limit report
Cached time: 20161129134324
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.037 seconds
Real time usage: 0.418 seconds
Preprocessor visited node count: 57/1000000
Preprocessor generated node count: 84/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 - -total
-->

<!-- Saved in parser cache with key df_wikiv3-wk:pcache:idhash:11964-0!*!*!!en!5!* and timestamp 20161129134324 and revision id 34539
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://www.dfrobot.com/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;oldid=34539">https://www.dfrobot.com/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;oldid=34539</a>"</div>

						<!-- end body text -->
					</div>
					<!-- category links -->
					<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">
				<!-- Tools-->
				<nav class="navbar navbar-default p-tb " id="p-tb"  >
					<ul class="nav navbar-nav small">
						<li id="t-whatlinkshere"><a href="/wiki/index.php/Special:WhatLinksHere/Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
						<li id="t-recentchangeslinked"><a href="/wiki/index.php/Special:RecentChangesLinked/Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
						<li id="t-specialpages"><a href="/wiki/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li>
						<li id="t-print"><a href="/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>
						<li id="t-permalink"><a href="/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;oldid=34539" title="Permanent link to this revision of the page">Permanent link</a></li>
						<li id="t-info"><a href="/wiki/index.php?title=Micro_DC_Motor_with_Encoder-SJ01_SKU:_FIT0450&amp;action=info" title="More information about this page">Page information</a></li>
						
					</ul>
				</nav>

			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">
				<!-- footer links -->
				<ul class="footer-info list-unstyled small" id="footer-info">
					<!-- info -->
					<li> This page was last modified on 13 May 2016, at 06:47.</li>
					<li>Content is available under <a class="external" rel="nofollow" href="https://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
				</ul>

			</div>
		</div>
		<div class="row">
			<div class="col-lg-6">
				<!-- places -->
				<ul class="list-inline footer-places " id="footer-places">
					<li><small><a href="/wiki/index.php/Robot_Wiki:Privacy_policy" title="Robot Wiki:Privacy policy">Privacy policy</a></small></li>
					<li><small><a href="/wiki/index.php/Robot_Wiki:About" title="Robot Wiki:About">About Robot Wiki</a></small></li>
					<li><small><a href="/wiki/index.php/Robot_Wiki:General_disclaimer" title="Robot Wiki:General disclaimer">Disclaimers</a></small></li>
				</ul>

			</div>
			<div class="col-lg-6">
				<!-- footer icons -->
				<ul class="list-inline pull-right footer-icons " id="footer-icons" >
					<!-- copyright -->
					<li><a href="https://www.gnu.org/copyleft/fdl.html"><img src="/wiki/resources/assets/licenses/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or later" width="88" height="31"/></a></li>
					<!-- poweredby -->
					<li><a href="//www.mediawiki.org/"><img src="/wiki/resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a></li>
				</ul>

			</div>
		</div>
	</div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.loader.state({"user":"ready","user.groups":"ready"});mw.loader.load(["mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.visualEditor.targetLoader","ext.bootstrap.scripts"]);});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":31});});</script></body>
</html>